A. Find the names of aircraft such that all pilots certified to operate them earn
more than $80,000.


SELECT ANAME,count(ename) FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID and salary>80000 group by ANAME HAVING COUNT(ENAME)>3;
   aname   | count 
-----------+-------
 sukhoi su |     5
 F-16      |     5
(2 rows)



B.. For each pilot who is certified for more than three aircraft, find the eid and the
maximum cruisingrange of the aircraft for which she or he is certified.

SELECT ENAME,COUNT(ANAME) FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID  group by ENAME HAVING COUNT(ANAME)>3
flightinformation-> ;
  ename  | count 
---------+-------
 SACHIN  |     6
 VISWASH |     4
 VAIBHAV |     4
(3 rows)

SELECT EMPLOYEES.EID,COUNT(ANAME) FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID  group by EMPLOYEES.EID HAVING COUNT(ANAME)>3
;
 eid | count 
-----+-------
 102 |     6
 101 |     4
 105 |     4
(3 rows)




E.Find the name of pilots certified with some boeing aircraft?

 SELECT ENAME ,ANAME FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID AND ANAME LIKE 'BOEING%';
   ename    |   aname    
------------+------------
 VAIBHAV    | BOEING 777
 ABHINANDAN | BOEING 777
 VISWASH    | BOEING C17
 VAIBHAV    | BOEING C17
 SACHIN     | BOEING C17
 VAIBHAV    | BOEING C20
 SACHIN     | BOEING C17
(7 rows)

D.For all aircraft with cruisingrange over 1000 miles, find the name of the aircraft and the average salary of all pilots certified for this aircraft?

SELECT ANAME,avg(salary) FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID AND cruiserange>1000 group by aname;
   aname    |        avg         
------------+--------------------
 BOEING C20 | 80000.000000000000
 BOEING C17 | 77500.000000000000
 MIG-29     | 70000.000000000000
(3 rows)


H.Print the enames of pilots who can operate planes with cruisingrange greater
than 3000 miles but are not certified on any Boeing aircraft?

 SELECT ENAME,CRUISERANGE,ANAME FROM EMPLOYEES,CERTIFIED,AIRCRAFT WHERE EMPLOYEES.EID=CERTIFIED.EID AND AIRCRAFT.AID=CERTIFIED.AID AND ANAME NOT LIKE'BOEING%' AND CRUISERANGE>3000;
   ename    | cruiserange | aname  
------------+-------------+--------
 MARTIN     |        4500 | F-16
 RATAN      |        5000 | MIG-21
 ABHINANDAN |        4500 | F-16
(3 rows)

J. Compute the difference between the average salary of a pilot and the average
salary of all employees (including pilots).


SELECT AVG(SALARY) FROM EMPLOYEES EXCEPT SELECT AVG(SALARY) FROM EMPLOYEES,CERTIFIED WHERE EMPLOYEES.EID=CERTIFIED.EID;
        avg         
--------------------
 99500.000000000000
(1 row)


k. Print the name and salary of every nonpilot whose salary is more than the
average salary for pilots.


select ename ,SALARY from employees where eid!= ALL (select eid from certified) AND SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES,CERTIFIED WHERE EMPLOYEES.EID=CERTIFIED.EID);
 ename | salary 
-------+--------
 SUMAN | 150000
(1 row)


f. Find the aids of all aircraft that can be used on routes from Los Angeles to
Chicago.

 SELECT AIRCRAFT.AID ,ANAME FROM AIRCRAFT,FLIGHTS WHERE AIRCRAFT.AID=FLIGHTS.AID AND SOURCE='LOS ANGELES' AND DESTINATION='CHICAGO';
 aid |   aname   
-----+-----------
   3 | sukhoi su
(1 row)

